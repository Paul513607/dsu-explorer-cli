{
  "workDir": ".",
  "dependencies": [
    {
      "name": "webcardinal/bundle",
      "src": "https://github.com/webcardinal/webcardinal-minimal-release",
      "actions": [
        {
          "type": "smartClone",
          "target": ".",
          "collectLog": false
        },
        {
          "type": "execute",
          "cmd": "cd webcardinal && npm install"
        }
      ]
    },
    {
      "name": "opendsu-sdk",
      "src": "http://github.com/opendsu/opendsu-sdk.git",
      "actions": [
        {
          "type": "smartClone",
          "target": ".",
          "collectLog": false
        },
        {
          "type": "execute",
          "cmd": "cd opendsu-sdk && npm install"
        }
      ]
    }
  ],
  "install-demo": [
    {
      "name": "Installing demo...",
      "actions": [
        {
          "type": "execute",
          "cmd": "npm run add demo-ssapp https://github.com/opendsu/ssapp-template"
        },
        {
          "type": "execute",
          "cmd": "npm run build-all"
        },
        {
          "type": "execute",
          "cmd": "npm run bind-wallet demo-wallet demo-ssapp"
        },
        {
          "type": "execute",
          "cmd": "npm run add-loader apihub-root/demo-wallet/loader https://github.com/OpenDSU/trust-loader"
        },
        {
          "type": "copy",
          "src": "./default-loader-config-files",
          "target": "./apihub-root/demo-wallet/loader",
          "options": {
            "overwrite": true,
            "ignoreErrors": true
          }
        }
      ]
    }
  ],
  "patch": [
    {
      "name": "trust-loader-config",
      "actions": [
        {
          "type": "copy",
          "src": "./trust-loader-config",
          "target": "./apihub-root",
          "options": {
            "overwrite": true,
            "ignoreErrors": true
          }
        }
      ]
    }
  ],
  "postinstall": [
    {
      "name": "trust-loader-config",
      "actions": [
        {
          "type": "execute",
          "cmd": "node ./node_modules/octopus/scripts/setEnv --file=../../../env.json \"node ./bin/octopusRun.js patch\""
        }
      ]
    },
    {
      "name": "copy-bundles",
      "actions": [
        {
          "type": "copy",
          "src": "./opendsu-sdk/psknode/bundles/webshims.js",
          "target": "./apihub-root/bundles/webshims.js",
          "options": {
            "overwrite": true
          }
        },
        {
          "type": "copy",
          "src": "./opendsu-sdk/psknode/bundles/loaderBoot.js",
          "target": "./apihub-root/bundles/loaderBoot.js",
          "options": {
            "overwrite": true
          }
        }
      ]
    }
  ],
  "ssapps-and-wallets-build": [
    {
      "name": "webcardinal-wallet-build",
      "actions": [
        {
          "type": "execute",
          "cmd": "cd webcardinal && npm run build"
        }
      ]
    }
  ],
  "build": [
    {
      "name": "build-all",
      "actions": [
        {
          "type": "execute",
          "cmd": "node ./node_modules/octopus/scripts/setEnv --file=../../../env.json \"node ./bin/octopusRun.js ssapps-and-wallets-build\""
        },
        {
          "type": "execute",
          "cmd": "node ./node_modules/octopus/scripts/setEnv --file=../../../env.json \"node ./bin/octopusRun.js postbuild\""
        }
      ]
    }
  ],
  "postbuild": [
    {
      "name": "patching trust loaders configs",
      "actions": [
        {
          "type": "execute",
          "cmd": "node ./node_modules/octopus/scripts/setEnv --file=../../../env.json \"node ./bin/octopusRun.js postinstall\""
        }
      ]
    }
  ]
}